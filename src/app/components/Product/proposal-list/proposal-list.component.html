<main id="main" class="main">
  <section class="section">

    <div class="card custom-card mb-3">
      <div class="card-body">
        <div class="btn-group mt-4">
          <button class="btn btn-primary" type="button" (click)="routeNewPage()">
            Yeni Teklif Yap
          </button>

        </div>
      </div>
    </div>

    <!-- Filtreleme Alanı (Bitiş) -->

    <div class="card">
      <p-table #dt5 [value]="proposals" [(selection)]="proposals" dataKey="id" [paginator]="true"
        [rowsPerPageOptions]="[5, 10, 20]" [resizableColumns]="true" expandableRows="true" columnResizeMode="expand"
        styleClass="p-datatable-gridlines p-datatable-striped" [rows]="10"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">

        <!-- <ng-template pTemplate="caption">
           <div class="p-4 card-body d-flex justify-content-start" style="overflow-x: auto">
             <p-splitButton label="İşlemler" [model]="items" appendTo="body"></p-splitButton>
           </div>
           <h5 *ngIf="selectedProposals.length > 0" style="text-align: left">
             {{ selectedProposals.length }}/{{ proposals.length }} Adet İşlem Seçildi
           </h5>
         </ng-template> -->

        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="id">
              ID
              <p-sortIcon field="id"></p-sortIcon>
            </th>
            <th pSortableColumn="count">
              Adet
              <p-sortIcon field="count"></p-sortIcon>
            </th>
            <th pSortableColumn="count2">
              Ürün Çeşit
              <p-sortIcon field="count2"></p-sortIcon>
            </th>
            <th pSortableColumn="createdDate">
              Oluşturulma Tarihi
              <p-sortIcon field="createdDate"></p-sortIcon>
            </th>
            <th pSortableColumn="user">
              Kullanıcı
              <p-sortIcon field="user"></p-sortIcon>
            </th>
            <th pSortableColumn="proposalNumber">
              Teklif Id
              <p-sortIcon field="proposalNumber"></p-sortIcon>
            </th>
            <th>İşlemler</th>
          </tr>
          <tr>
            <th>
              <p-columnFilter type="text" field="id" [showClearButton]="false"></p-columnFilter>
            </th>
            <th>
              <p-columnFilter type="text" field="count" [showClearButton]="false"></p-columnFilter>
            </th>
            <th>
              <p-columnFilter type="text" field="count2" [showClearButton]="false"></p-columnFilter>
            </th>
            <th>
              <p-columnFilter type="date" field="createdDate" [showClearButton]="false"></p-columnFilter>
            </th>
            <th>
              <p-columnFilter type="text" field="user" [showClearButton]="false"></p-columnFilter>
            </th>
            <th>
              <p-columnFilter type="text" field="proposalNumber" [showClearButton]="false"></p-columnFilter>
            </th>
            <th></th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-proposal>
          <tr>
            <td>{{ proposal.id }}</td>
            <td>{{ proposal.count }}</td>
            <td>{{ proposal.count2 }}</td>
            <td>{{ proposal.createdDate | date : "dd.MM.yyyy HH:mm" }}</td>
            <td>{{ proposal.user }}</td>
            <td>{{ proposal.proposalNumber }}</td>
            <td>
              <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown"
                aria-expanded="false">
              </button>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" routerLink="/create-proposal/{{proposal.id}}">
                    <i class="fas fa-sliders-h"></i> İşlemler
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" (click)="deleteProposal(proposal.id)">
                    <i class="fas fa-trash"></i> Teklifi Sil
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" (click)="createProposalReport(proposal)">
                    <i class="fa fa-file-pdf-o" aria-hidden="true"></i>
                    Pdf Çıktısı Al
                  </a>
                </li>
              </ul>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <p-dialog header="Teklifi Tamamla" [(visible)]="completeDialog" [modal]="true" [closable]="false"
      [style]="{width: '500px'}">
      <div class="row">

        <div class="col-md-4"><button class="btn btn-success" (click)="_createProposalReport(1)">Kdvli Rapor</button>
        </div>
        <div class="col-md-4"><button class="btn btn-success" (click)="_createProposalReport(2)">Kdvsiz Rapor</button>
        </div>
        <div class="col-md-4"><button class="btn btn-success" (click)="_createProposalReport(3)">Kdvsiz Rapor
            (Görselsiz)</button>
        </div>

      </div>
    </p-dialog>
  </section>
</main>
