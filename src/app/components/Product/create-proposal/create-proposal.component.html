<main id="main" class="main">
  <section class="section">


    <div class="card">
      <div class="card-body">

        <form [formGroup]="getProductsForm" (ngSubmit)="searchProposalProducts(getProductsForm.value)" class="mt-4">
          <div class="row">
            <div class="form-group col-md-6 mb-3">
              <div class="input-group">
                <input pInputText placeholder="Ürün Kodu" type="text" id="itemCode" class="form-control"
                  formControlName="itemCode" required />
              </div>
            </div>
            <div class="form-group col-md-6 mb-3">
              <button class="btn btn-primary" type="submit" style="width: 100%">
                <i class="fa fa-search" aria-hidden="true"></i>
              </button>
            </div>

          </div>

          <div class="row">


          </div>
        </form>

      </div>
    </div>

    <!-- <p-dialog header="Ürün Seç" [(visible)]="searchedProductDialog" [style]="{ width: '80vw' }" modal="true"
      [dismissableMask]="true">
      <div class="card" *ngIf="_products.length > 0">
        <div class="card-body">
          <h5 class="card-title">Ürünler</h5>

          <div class="table-responsive">
            <table class="table table-bordered table-striped">
              <thead>
                <tr>
                  <th scope="col">Resim</th>
                  <th scope="col">Stok Kodu</th>
                  <th scope="col">Ürün</th>
                  <th scope="col">Renk</th>
                  <th scope="col">Beden</th>
                  <th scope="col">Barkod</th>
                  <th scope="col">Fiyat-1</th>
                  <th scope="col">Fiyat-2</th>
                  <th scope="col">Özellik-1</th>
                  <th scope="col">Özellik-2</th>
                  <th scope="col">Özellik-3</th>
                  <th scope="col">Özellik-4</th>
                  <th scope="col">Özellik-5</th>
                  <th scope="col">İşlemler</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let product of _products; let i = index">

                  <td class="image-icon-td">
                    <p-image src="{{ product.photoUrl }}" alt="Image" width="30" [preview]="true"></p-image>
                  </td>
                  <td>{{ product.itemCode }}</td>
                  <td>{{ product.itemDescription}}</td>
                  <td>{{ product.colorDescription }}</td>
                  <td>{{ product.itemDim1Code }}</td>
                  <td>{{ product.barcode }}</td>
                  <td>{{ product.price }}</td>
                  <td>{{ product.price2}}</td>
                  <td>{{ product.attribute1}}</td>
                  <td>{{ product.attribute2}}</td>
                  <td>{{ product.attribute3}}</td>
                  <td>{{ product.attribute4}}</td>
                  <td>{{ product.attribute5}}</td>
                  <td> <button class="btn btn-primary" type="submit" style="height: 100%"
                      (click)="addProposalProduct(product)">
                      <i class="fa fa-plus" aria-hidden="true"></i>
                    </button></td>

                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </p-dialog> -->

    <div class="card">
      <div class="card-body">
        <p-table [scrollable]="true" [value]="selectedProducts" styleClass="p-datatable-striped" dataKey="lineId">
          <ng-template pTemplate="caption">
            Seçilen Ürünler
          </ng-template>

          <ng-template pTemplate="header">
            <tr>
              <th scope="col">Resim</th>
              <th scope="col">Kod</th>
              <th scope="col">Miktar</th>
              <!-- <th scope="col">Birim Fiyat</th> -->
              <th scope="col"> Fiyat</th>
              <th scope="col">Tutar</th>
              <th scope="col">Envanter</th>
              <th scope="col">Ürün</th>
              <th scope="col">Düzenle</th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-product let-ri="rowIndex">
            <tr>
              <td class="image-icon-td">
                <p-image src="{{ product.photoUrl }}" alt="Image" width="50" [preview]="true"></p-image>
              </td>
              <td>{{ product.itemCode }}</td>
              <td>{{ product.quantity2 }}</td>
              <!-- <td>{{ product.basePrice }}</td> -->
              <td>{{ product.discountedPrice }}</td>
              <td>{{ product.quantity2 * product.discountedPrice }}</td>
              <td>{{ product.quantity }}</td>
              <td>{{ product.description }}</td>
              <td>
                <button class="btn btn-primary">
                  <i class="fa fa-pencil" aria-hidden="true"></i>
                </button>

                <button class="btn btn-primary">
                  <i class="fa fa-minus" aria-hidden="true" (click)="deleteProposalProduct(product.id)"></i>
                </button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
    <p-dialog modal="true" header="Önerilen Ürünler" [(visible)]="suggestedProductsDialog" [style]="{ width: '80vw' }">
      <p-table [scrollable]="true" [value]="suggestedProducts" styleClass="p-datatable-striped">
        <ng-template pTemplate="header">
          <tr>
            <th>Aranan Ürün Kodu</th>
            <th>Muadil Ürün Kodu</th>
            <th>Envanter</th>
            <th>İşlemler</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product>
          <tr>
            <td>{{ product?.itemCode }}</td>
            <td>{{ product?.suggestedItemCode }}</td>
            <td>{{ product?.suggestedItemInventory }}</td>

            <td>
              <button pButton pRipple class="p-button-rounded p-button-text" icon="pi pi-plus"
                (click)="routeGetProduct( product?.suggestedItemCode)" type="submit"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-dialog>
  </section>
</main>
