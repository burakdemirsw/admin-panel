<main id="main" class="main">
  <section class="section">


    <div class="card mb-3  p-4 ">
      <div class="card-body">
        <div class="btn-group" role="group" aria-label="Basic example">
          <button type="button" class="btn btn-primary" (click)="getOrders(true)">
            <i class="fas fa-check"></i> Aktarılan Siparişler
          </button>
          <button type="button" class="btn btn-primary " (click)="getOrders(false)">
            <i class="fas fa-times-circle"></i> Aktarılmayan Siparişler
          </button>
          <button type="button" class="btn btn-primary " (click)="routePage()">
            <i class="fas fa-check"></i> Sipariş Ver
          </button>
        </div>
      </div>
    </div>

    <p-panel header="Filtre" [toggleable]="true" [collapsed]="true">
      <form [formGroup]="clientOrderFilterForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="customerCode">Müşteri Kodu</label>
          <input id="customerCode" formControlName="customerCode" class="form-control" type="text">
        </div>

        <div class="form-group">
          <label for="salesPersonCode">Satış Temsilcisi Kodu</label>
          <input id="salesPersonCode" formControlName="salesPersonCode" class="form-control" type="text">
        </div>

        <div class="form-group">
          <label for="salesPersonDescription">Satış Temsilcisi Açıklaması</label>
          <input id="salesPersonDescription" formControlName="salesPersonDescription" class="form-control" type="text">
        </div>

        <div class="form-group">
          <label for="paymentDescription">Ödeme Açıklaması</label>
          <input id="paymentDescription" formControlName="paymentDescription" class="form-control" type="text">
        </div>

        <div class="form-group">
          <label for="orderNo">Sipariş Numarası (Uygulama)</label>
          <input id="orderNo" formControlName="orderNo" class="form-control" type="text">
        </div>

        <div class="form-group">
          <label for="orderNumber">Sipariş Numarası (Nebim)</label>
          <input id="orderNumber" formControlName="orderNumber" class="form-control" type="text">
        </div>

        <div class="form-group">
          <label for="createdDate">Oluşturulma Tarihi</label>
          <input id="createdDate" formControlName="createdDate" class="form-control" type="date">
        </div>

        <div class="form-group">
          <label for="updatedDate">Güncellenme Tarihi</label>
          <input id="updatedDate" formControlName="updatedDate" class="form-control" type="date">
        </div>

        <div class="form-group">
          <label for="customerDescription">Müşteri Açıklaması</label>
          <input id="customerDescription" formControlName="customerDescription" class="form-control" type="text">
        </div>

        <div class="form-group form-check">
          <input id="isCancelled" formControlName="isCancelled" class="form-check-input" type="checkbox">
          <label for="isCancelled" class="form-check-label">İptal Edildi</label>
        </div>


        <button type="submit" class="btn btn-primary">Filtreyi Uygula</button>
      </form>
    </p-panel>

    <div class="card"></div>
    <div class="card">
      <p-table [value]="orders" dataKey="id" [rows]="25" [paginator]="true" [rowsPerPageOptions]="[25, 50, 75,100]"
        [globalFilterFields]="[
            'customerDescription',
            'orderNo',
            'cargoStatus'
          ]" [tableStyle]="{ 'min-width': '75rem' }" styleClass="p-datatable-striped">
        <ng-template pTemplate="header">
          <tr>
            <th>Satış Sorumlusu</th>
            <th>Müşteri</th>
            <th>Alt Müşteri</th>
            <th>Sipariş No</th>
            <th>Ödeme</th>
            <th>Kargo Durumu</th>
            <th>İptal Durumu</th>
            <th>Sipariş Numarası</th>
            <th>Oluşturulma Zamanı</th>
            <th>Adet</th>
            <th>İşlemler</th>
          </tr>
          <tr>
            <th>
              <p-columnFilter type="text" field="salesPersonDescription" placeholder="Satış Elemanına göre ara"
                ariaLabel="Satış Elemanı" />
            </th>
            <th>
              <p-columnFilter type="text" field="customerDescription" placeholder="Bayiye göre ara"
                ariaLabel="Müşteri" />
            </th>
            <th>
              <p-columnFilter type="text" field="subCustomerDescription" placeholder="Alt Müşteriye göre ara"
                ariaLabel="Müşteri" />
            </th>
            <th>
              <p-columnFilter type="text" field="orderNo" placeholder="Sipariş No'ya göre ara" ariaLabel="Sipariş No" />
            </th>
            <th>
              <p-columnFilter type="text" field="paymentDescription" placeholder="Ödemeye göre ara" ariaLabel="Ödeme" />
            </th>
            <th>
              <p-columnFilter type="text" field="isCancelled" placeholder="İptal Durumu" ariaLabel="İptal Durumu" />
            </th>
            <th>
              <p-columnFilter type="text" field="cargoStatus" placeholder="Kargo Durumuna göre ara"
                ariaLabel="Kargo Durumu" />
            </th>
            <th>
              <p-columnFilter type="text" field="orderNumber" placeholder="Sipariş Numarası"
                ariaLabel="Sipariş Numarası" />
            </th>
            <th>
              <!-- Filtre yok -->
            </th>
            <th>
              <!-- Filtre yok -->
            </th>
            <th>
              <!-- Filtre yok -->
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-order>
          <tr>
            <td>{{ order.clientOrder.salesPersonDescription }}</td>
            <td>{{ order.clientOrder.customerDescription }}</td>
            <td>{{ order.clientOrder.subCustomerDescription }}</td>
            <td>{{ order.clientOrder.orderNo }}</td>
            <td>{{ order.clientOrder.paymentDescription }}</td>

            <td>{{ order.clientOrder.cargoStatus }}</td>
            <td>
              <button class="btn {{ order.clientOrder.isCancelled ? 'btn-danger' : 'btn-success' }}">
                <i class="fa {{ order.clientOrder.isCancelled ? 'fa-ban' : 'fa-check' }}"></i>
              </button>
            </td>
            <td>{{ order.clientOrder.orderNumber }}</td>
            <td>{{ order.clientOrder.createdDate | date : "dd.MM.yyyy HH:mm" }}</td>
            <td>{{ order.clientOrderBasketItems?.length}}</td>
            <td>
              <div class="btn-group">


                <div class="btn btn-success" data-text="Siparişe Git" (click)="route(order)">
                  <i class="fa fa-bars" aria-hidden="true"></i>
                </div>
                <div class="btn btn-success" data-text="İptal" *ngIf="order.clientOrder.isCompleted"
                  (click)="updateClientOrderCancelStatus(order.clientOrder.id, order.clientOrder.isCancelled)">
                  <i class="fa fa-ban" aria-hidden="true"></i>
                </div>
                <div class="btn btn-success" data-text="Kargo" (click)="deleteClientOrder(order.clientOrder.id)">
                  <i class="fa fa-trash" aria-hidden="true"></i>
                </div>
                <div class="btn btn-success" data-text="Müşteri Güncelle"
                  routerLink="/customer/update/{{order.clientOrder.customerCode}}">
                  <i class="fa fa-pencil" aria-hidden="true"></i>
                </div>
                <div class="btn btn-success" data-text="Kargo" (click)="updateCargoStatus(order.clientOrder)">
                  <i class="fa fa-truck" aria-hidden="true"></i>
                </div>
              </div>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="5">Herhangi bir sipariş bulunamadı.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </section>
</main>
